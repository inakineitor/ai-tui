# Package Rename & Deployment Setup Plan

## Overview

Rename packages from `@acme/*` to `@ai-tui/*` scope, reorganize folder structure, and set up GitHub Actions for npm publishing + Vercel for docs deployment.

### Package Mapping

| Current | New Name | Folder Change | Published to npm |
|---------|----------|---------------|------------------|
| `@acme/core` | `@ai-tui/core` | `packages/acme-core` → `packages/core` | Yes |
| `@acme/utils` | `@ai-tui/components` | `packages/acme-utils` → `packages/components` | Yes |
| `@acme/tsconfig` | `@ai-tui/tsconfig` | `packages/acme-tsconfig` → `packages/tsconfig` | No (private) |
| `@acme/docs` | `@ai-tui/docs` | `apps/docs` (no change) | No (Vercel only) |

---

## Pre-requisites (Manual)

Before implementation:

1. **Create npm organization** at [npmjs.com/org/create](https://www.npmjs.com/org/create) for `@ai-tui` scope
2. **Verify package names available** (only these two will be published):
   ```bash
   npm view @ai-tui/core        # should return 404 (not found)
   npm view @ai-tui/components  # should return 404 (not found)
   ```

Note: `@ai-tui/tsconfig` and `@ai-tui/docs` remain private and are not published to npm.

---

## Phase 1: Clean State

```bash
pnpm clean
rm -rf node_modules pnpm-lock.yaml .turbo
```

---

## Phase 2: Folder Renames (via git mv)

```bash
git mv packages/acme-tsconfig packages/tsconfig
git mv packages/acme-core packages/core
git mv packages/acme-utils packages/components
```

---

## Phase 3: Package.json Updates

### `/packages/tsconfig/package.json`
- `name`: `@acme/tsconfig` → `@ai-tui/tsconfig`

### `/packages/core/package.json`
- `name`: `@acme/core` → `@ai-tui/core`
- `devDependencies.@acme/tsconfig` → `@ai-tui/tsconfig`

### `/packages/components/package.json`
- `name`: `@acme/utils` → `@ai-tui/components`
- `devDependencies.@acme/tsconfig` → `@ai-tui/tsconfig`

### `/apps/docs/package.json`
- `name`: `@acme/docs` → `@ai-tui/docs`
- `dependencies.@acme/core` → `@ai-tui/core`
- `dependencies.@acme/utils` → `@ai-tui/components`
- `devDependencies.@acme/tsconfig` → `@ai-tui/tsconfig`

### `/package.json` (root)
- `scripts.release`: change filter from `@acme/docs` to `@ai-tui/docs`

---

## Phase 4: TypeScript Config Updates

### `/packages/core/tsconfig.json`
- `extends`: `@acme/tsconfig/react-library.json` → `@ai-tui/tsconfig/react-library.json`

### `/packages/components/tsconfig.json`
- `extends`: `@acme/tsconfig/react-library.json` → `@ai-tui/tsconfig/react-library.json`

### `/apps/docs/tsconfig.json`
- `extends`: `@acme/tsconfig/nextjs.json` → `@ai-tui/tsconfig/nextjs.json`

---

## Phase 5: Source Code Updates

### `/apps/docs/src/app/page.tsx`
```diff
- import { Button } from "@acme/core";
+ import { Button } from "@ai-tui/core";
```

---

## Phase 6: Changesets Config Update

### `/.changeset/config.json`
- `ignore`: `["@acme/docs"]` → `["@ai-tui/docs"]`

---

## Phase 7: README Update

Update `/README.md`:
- Replace all `@acme/` references with `@ai-tui/`
- Update folder structure documentation
- Update package names in examples

---

## Phase 8: Reinstall Dependencies

```bash
pnpm install
```

---

## Phase 9: Create GitHub Actions Workflow

### Create `/.github/workflows/release.yml`

```yaml
name: Release

on:
  push:
    branches:
      - main

concurrency: ${{ github.workflow }}-${{ github.ref }}

jobs:
  release:
    name: Release
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      id-token: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup pnpm
        uses: pnpm/action-setup@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "pnpm"
          registry-url: "https://registry.npmjs.org"

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Create Release Pull Request or Publish
        id: changesets
        uses: changesets/action@v1
        with:
          publish: pnpm release
          version: pnpm version-packages
          title: "chore: version packages"
          commit: "chore: version packages"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
```

---

## Phase 10: Vercel Setup (Manual)

1. Go to [vercel.com/new](https://vercel.com/new)
2. Import the GitHub repository
3. Configure:
   - **Framework:** Next.js
   - **Root Directory:** `apps/docs`
   - **Build Command:** `cd ../.. && pnpm turbo run build --filter=@ai-tui/docs`
   - **Install Command:** `cd ../.. && pnpm install`

---

## Phase 11: Repository Secrets (Manual)

Add to GitHub repository settings → Secrets → Actions:

| Secret | Source |
|--------|--------|
| `NPM_TOKEN` | [npmjs.com/settings/~/tokens](https://www.npmjs.com/settings/~/tokens) → Automation token |

---

## Verification Steps

After all changes:

```bash
# Build all packages
pnpm build

# Type check
pnpm exec tsc --noEmit

# Lint check
pnpm check

# Validate package exports
pnpm lint:package

# Start dev server
pnpm dev
```

Verify docs app loads correctly at `http://localhost:3000`

---

## Files Summary

### Modified Files
- `/packages/tsconfig/package.json`
- `/packages/core/package.json`
- `/packages/components/package.json`
- `/apps/docs/package.json`
- `/package.json`
- `/packages/core/tsconfig.json`
- `/packages/components/tsconfig.json`
- `/apps/docs/tsconfig.json`
- `/apps/docs/src/app/page.tsx`
- `/.changeset/config.json`
- `/README.md`

### Created Files
- `/.github/workflows/release.yml`

### Regenerated Files
- `/pnpm-lock.yaml`

---

## Post-Migration: First Release

After merging:

1. Create changeset: `pnpm changeset`
2. Select `@ai-tui/core` and `@ai-tui/components` (only publishable packages)
3. Choose `major` version (new namespace = breaking change)
4. Commit and push
5. Merge the auto-created "Version Packages" PR

Note: `@ai-tui/tsconfig` and `@ai-tui/docs` won't appear in changeset prompts since they're private.
