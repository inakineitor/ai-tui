# Plan: Publish Packages to npm

## Summary

The repo is already well-configured for npm publishing with CI/CD automation via GitHub Actions. Two packages (`@ai-tui/core` and `@ai-tui/components`) are ready to be published to the `ai-tui` npm organization.

---

## Current State

| Aspect | Status |
|--------|--------|
| Publishable Packages | `@ai-tui/core`, `@ai-tui/components` |
| Current Version | 0.0.0 (not yet released) |
| Package Entry Points | Properly configured (ESM/CJS/types) |
| Publishing Tool | Changesets (configured) |
| Release Script | `pnpm release` |
| CI/CD Workflow | `.github/workflows/release.yml` exists |
| npm Org | `ai-tui` (confirmed exists) |

---

## What's Needed to Publish

### 1. Add `NPM_TOKEN` Secret to GitHub

The workflow requires an `NPM_TOKEN` secret:

1. Go to npmjs.com → Account Settings → Access Tokens
2. Generate a new **Automation** token (for CI/CD use)
3. Go to your GitHub repo → Settings → Secrets and variables → Actions
4. Add a new secret named `NPM_TOKEN` with the token value

### 2. Fix Workflow Issues

The current `.github/workflows/release.yml` has two issues:

**Issue 1:** pnpm version mismatch
- Workflow uses pnpm 8, repo requires pnpm 10.28.2
- Line 19-21: Change `version: 8` to `version: 10`

**Issue 2:** Broken Slack notification step
- Line 44 references `my-slack-bot` which doesn't exist
- Remove or comment out lines 41-44

### 3. Create Initial Changeset

```bash
pnpm changeset
```

- Select both `@ai-tui/core` and `@ai-tui/components`
- Choose version bump (e.g., `minor` for 0.1.0 or `major` for 1.0.0)
- Write a summary of what the packages provide

### 4. Commit and Push

```bash
git add .
git commit -m "chore: add changeset for initial release"
git push
```

### 5. Automated Release Process

Once pushed to `main`, GitHub Actions will:

1. Detect the changeset
2. Create a "Version Packages" PR automatically
3. When you merge that PR, it will:
   - Build the packages
   - Publish to npm
   - Create git tags

---

## Files to Modify

| File | Change |
|------|--------|
| `.github/workflows/release.yml:19-21` | Update pnpm version from 8 to 10 |
| `.github/workflows/release.yml:41-44` | Remove broken Slack notification step |

---

## Pre-publish Checklist

- [ ] `NPM_TOKEN` secret added to GitHub repo
- [ ] Workflow fixes applied (pnpm version, remove Slack step)
- [ ] Packages build successfully (`pnpm build`)
- [ ] Package linting passes (`pnpm turbo lint:package`)
- [ ] Initial changeset created (`pnpm changeset`)

---

## Verification

After the first release:

1. Check npm for published packages:
   - https://www.npmjs.com/package/@ai-tui/core
   - https://www.npmjs.com/package/@ai-tui/components

2. Test installation in a new project:
   ```bash
   pnpm add @ai-tui/core @ai-tui/components
   ```

3. Verify git tags were created:
   ```bash
   git tag -l
   ```
